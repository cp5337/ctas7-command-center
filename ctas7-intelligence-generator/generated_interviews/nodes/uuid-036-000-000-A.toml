```toml
# ============================================================================
# CTAS-7 Node Interview Schema v7.3.1
# Complete Intelligence Integration Architecture
# ============================================================================
# This is the canonical schema for generating 165 node interviews from the
# IED TTL (Terrorist IED Task List). Each node represents an adversary task
# with first-person narrative, intelligence requirements, and operational context.
#
# Integration Points:
# - Computational: Trivariate hashing (SCH+CUID+UUID), Unicode ops, XSD
# - Semantic: First-person narrative, EEIs, TTPs, relationships
# - Tactical: HD4 phase mapping (Hunt/Detect/Disrupt/Disable/Dominate)
# - Ontological: NIEM IEPD alignment, N-DEx field mapping
# - Toolchain: 1n (defensive) + 2n (offensive) tool stacks
# - Geospatial: GEE layers, weather, traffic, COMINT, terrain
# ============================================================================

[node_identity]
task_id = "uuid-036-000-000-A"              # TTL task identifier
task_name = "Remote Observation Post"
classification = "unclassified"              # or "cui", "secret", etc.
ttl_category = "mandatory"                   # mandatory | desirable | optional

# ============================================================================
# TRIVARIATE HASH (48-position Base96: SCH-CUID-UUID)
# ============================================================================
# Generated via Murmur3 with different seeds for each component.
# Full hash example: "Xk9mP2vL8qR4wN7jT20250109G40N74SU5e8400e29b41d4a"
# ============================================================================

sch = "a92Bq7mL8qR4wN7j"                    # Positions 1-16: Semantic Content Hash
                                             # Deterministic, content-based
                                             # Seed: 0x1234 (Murmur3)
                                             # Input: task_name + ttl_category + indicators

cuid = "T20250315G34N84SRO"                    # Positions 17-32: Contextual Unique ID
                                             # Spatio-temporal + semantic context
                                             # Seed: 0x5678 (Murmur3)
                                             # Format breakdown:
                                             #   T20250109 = Temporal (8 chars): YYYYMMDD or T-{offset}d
                                             #   G40N74    = Geographic (6 chars): Compressed lat/lon
                                             #   S         = Semantic domain (2 chars): "Sr" = Surveillance/Recon
                                             # Full encoding: T{time}G{geo}S{semantic}

uuid = "V5e8400e29b41d4b"                    # Positions 33-48: Universal Unique ID
                                             # Global uniqueness, persistence, audit trail
                                             # Seed: 0x9abc (Murmur3)
                                             # Input: UUID v4 + content + timestamp

hash_48 = "a92Bq7mL8qR4wN7jT20250315G34N84SROV5e8400e29b41d4b"  # Full 48-char hash

# ============================================================================
# FIRST-PERSON ADVERSARY NARRATIVE
# ============================================================================
# This is the core intelligence requirement. Written from the adversary's
# perspective, describing capabilities, methods, and intent.
# ============================================================================

[capabilities]
narrative = """
I am the long shadow, the unseen observer. I establish a position outside the immediate
perimeter, using binoculars, spotting scopes, and long-range cameras. My post is chosen
for concealment, cover, and unobstructed views. I blend into the environment: a construction
worker, a park visitor, a delivery driver.

I document patterns: vehicle movements, pedestrian traffic, deliveries, security patrols.
I log times, descriptions, and license plate numbers. I use digital cameras to capture
high-resolution images and video. I monitor radio frequencies for security communications.

I use weather data to predict optimal viewing conditions. I exploit elevated positions:
rooftops, parking garages, hilltops. I maintain a low profile, avoiding direct interaction
with personnel. My observation point is my silent eye, relaying information back to the team.
"""

limitations = """
I am limited by distance and atmospheric conditions. Image quality degrades with range,
fog, rain, and haze. My observation point is vulnerable to discovery‚Äîcounter-surveillance,
random patrols, or curious onlookers. I am exposed to the elements‚Äîheat, cold, rain.

I rely on line-of-sight. Obstructions‚Äîtrees, buildings, vehicles‚Äîlimit my field of view.
My equipment has limitations‚Äîbattery life, memory capacity, transmission range. I am
vulnerable to signal jamming and electronic surveillance. If compromised, my entire
operation could be exposed.
"""

# ============================================================================
# TIME-OF-VALUE (Intelligence Decay)
# ============================================================================
# Defines the actionable window and decay curve for this intelligence type.
# Uses "on the order of" language for human readability + numerical ranges.
# ============================================================================

[time_of_value]
half_life = { words = "weeks to months", range = [14, 60], units = "days" }
collection_phase = { words = "months to years before", range = [90, 365], units = "days" }
actionable_window = { words = "months", range = [30, 120], units = "days" }
decay_curve = "exponential"  # exponential | linear | step_function
ephemeral_conditions = [
  "Changes in security personnel or patrol routes",
  "Relocation of observation post due to compromise",
  "Changes in weather patterns affecting visibility",
  "Construction or modifications blocking line-of-sight"
]
persistence_conditions = [
  "Geographic layout of the surrounding area",
  "Structural features of the observation point",
  "Fixed patterns of activity at the target location",
  "Long-term traffic patterns"
]

# ============================================================================
# CONTEXTUAL HASHING (CUID Mask with Environmental Context)
# ============================================================================
# The CUID (positions 17-32) encodes spatio-temporal + semantic + environmental
# context using PREFIX and SUFFIX masks from CTAS 7.3 Ground Truth.
# ============================================================================

[cuid_mask]
# Temporal context
temporal = "T-{90-365}d"                     # Collection window: 60-180 days before attack
temporal_format = "YYYYMMDD"                 # Or "T-{offset}d" for relative time

# Geographic context
geographic = "G{lat}{lon}"                   # Compressed: G40N74 = 40.7¬∞N, 74.0¬∞W
geographic_radius_km = 25.0                  # Operational radius from target

# Semantic domain
semantic = "SRO"                              # Two-char code: Sr = Surveillance/Recon
semantic_full = "recon:remote:observation"  # Full ontology path

# PREFIX MASKS (Global Environmental Context) - Domain-Specific
[cuid_mask.prefix]
# Universal masks (all domains)
WX = "weather_mask"                          # Physical: Visibility, precip, wind, temp
                                             # Cyber: Network weather (latency, jitter)
                                             # Space: Solar radiation, space weather
                                             # Maritime: Sea state, visibility, wind

TF = "traffic_mask"                          # Physical: Road speed, congestion
                                             # Cyber: Network traffic, bandwidth utilization
                                             # Space: Orbital congestion, debris density
                                             # Maritime: Shipping lane traffic

OB = "order_of_battle_mask"                  # Friendly/enemy posture (all domains)
JU = "jurisdiction_mask"                     # Legal/authority overlay (all domains)
TH = "threat_posture_mask"                   # Threat level indicators (all domains)

# Domain-Specific Extensions (v7.3)
[cuid_mask.prefix.space]
SR = "solar_radiation"                       # Solar radiation impact (0-1)
GM = "geomagnetic_disturbance"               # Geomagnetic storm activity (0-1)
DE = "debris_density"                        # Orbital debris field density (0-1)
JS = "jurisdictional_shell"                  # LEO/MEO/GEO orbital layer

[cuid_mask.prefix.cyber]
NW = "network_weather"                       # Latency, jitter, packet loss
DT = "data_traffic"                          # Bandwidth utilization, flow rate
AS = "attack_surface"                        # Exposed services, vulnerabilities
FW = "firewall_posture"                      # Security boundary status

[cuid_mask.prefix.maritime]
SS = "sea_state"                             # Wave height, sea conditions (Beaufort scale)
CT = "current_tide"                          # Ocean currents, tidal state
SL = "shipping_lanes"                        # Proximity to commercial traffic
TW = "territorial_waters"                    # Jurisdictional boundaries (12nm, 200nm EEZ)
SC = "submarine_cables"                      # Proximity to undersea infrastructure
PT = "port_traffic"                          # Harbor/port congestion

[cuid_mask.prefix.network]
TP = "topology"                              # Network topology complexity
RT = "routing"                               # Routing table stability, BGP health
LT = "latency"                               # End-to-end latency metrics
PL = "packet_loss"                           # Packet loss percentage
BU = "bandwidth_utilization"                 # Link utilization percentage
AS = "autonomous_system"                     # AS-level routing context

# SUFFIX MASKS (Local Operational Context)
[cuid_mask.suffix]
RP = "personnel_availability"                # Staffing levels (or automated systems)
RE = "equipment_readiness"                   # Operational status
RS = "supplies_availability"                 # Resource/fuel availability
BW = "bandwidth_comms"                       # Connectivity status
RO = "rules_of_engagement"                   # Legal constraints

# Priority
priority = "high"                            # low | medium | high | critical

# ============================================================================
# HD4 TACTICAL MAPPING
# ============================================================================
# Maps this node to the 5 phases of the HD4 kill chain.
# ============================================================================

[hd4_phases]
hunt = { enabled = true, priority = "high", description = "Proactive search for remote observation posts" }
detect = { enabled = true, priority = "critical", description = "Identify remote observation activity in real-time" }
disrupt = { enabled = true, priority = "medium", description = "Counter-surveillance to deter remote observation" }
disable = { enabled = false, priority = "low", description = "Difficult to disable remote observation without detection" }
dominate = { enabled = false, priority = "low", description = "Not applicable to remote observation" }

# ============================================================================
# INDICATORS (Observable Signatures)
# ============================================================================
# Key indicators that this task is occurring. Used for detection and hunting.
# ============================================================================

[[indicators]]
observable = "Unexplained presence of individuals with binoculars/cameras near target"
priority = "high"
detection_method = "Security patrols, CCTV monitoring"
false_positive_rate = "medium"

[[indicators]]
observable = "Rental vehicle parked for extended periods near target"
priority = "medium"
detection_method = "License plate recognition, parking enforcement"
false_positive_rate = "low"

[[indicators]]
observable = "Increased foot traffic on rooftops or in high vantage points"
priority = "medium"
detection_method = "Building maintenance reports, security guard patrols"
false_positive_rate = "low"

[[indicators]]
observable = "Use of radio scanners or spectrum analyzers near target"
priority = "medium"
detection_method = "RF detection systems, security guard observation"
false_positive_rate = "medium"

[[indicators]]
observable = "Photographs of target location appearing on suspicious online forums"
priority = "high"
detection_method = "OSINT monitoring, dark web analysis"
false_positive_rate = "low"

[[indicators]]
observable = "Anomalous activity near communications infrastructure"
priority = "medium"
detection_method = "Telecom provider monitoring, physical security audits"
false_positive_rate = "medium"

[[indicators]]
observable = "Increased queries for satellite imagery of target location"
priority = "low"
detection_method = "Geospatial intelligence analysis, commercial data monitoring"
false_positive_rate = "high"

[[indicators]]
observable = "Pattern of individuals loitering for extended periods of time near known security vulnerabilities."
priority = "high"
detection_method = "Video analytics, security reports"
false_positive_rate = "medium"

[[indicators]]
observable = "Unexpected maintenance or construction activity near sensitive locations"
priority = "medium"
detection_method = "Permitting records, on-site verification"
false_positive_rate = "low"

[[indicators]]
observable = "Reports of unusual weather-related data collection near target facility"
priority = "low"
detection_method = "Weather service monitoring, community reporting"
false_positive_rate = "high"

# ============================================================================
# TOOLCHAIN (1n Defensive + 2n Offensive)
# ============================================================================
# Dual-mode tool stacks: same tools, different semantic context.
# ============================================================================

[[toolchain]]
tool = "Binoculars/Spotting Scope"
mode_1n = "Audit line-of-sight vulnerabilities from neighboring buildings."
mode_2n = "Conduct remote visual surveillance of target."
escalation_level = "script"
kali_package = "N/A"
resource_cost = "low"

[[toolchain]]
tool = "Digital Camera w/ long-range lens"
mode_1n = "Document potential blind spots in existing CCTV coverage."
mode_2n = "Capture high-resolution images of target infrastructure."
escalation_level = "script"
kali_package = "N/A"
resource_cost = "low"

[[toolchain]]
tool = "Radio Scanner/Spectrum Analyzer"
mode_1n = "Detect unauthorized radio transmissions near the facility."
mode_2n = "Monitor security frequencies and communications."
escalation_level = "microkernel"
kali_package = "gqrx"
resource_cost = "low"

[[toolchain]]
tool = "Google Earth/Sentinel Explorer"
mode_1n = "Identify potential offsite vantage points and approach routes."
mode_2n = "Plan optimal observation post locations and escape routes."
escalation_level = "script"
kali_package = "N/A"
resource_cost = "low"

[[toolchain]]
tool = "Kismet/Airodump-ng"
mode_1n = "Map unauthorized wireless networks within the facility's proximity."
mode_2n = "Identify wireless access points for potential exploitation."
escalation_level = "microkernel"
kali_package = "kismet, aircrack-ng"
resource_cost = "low"

[[toolchain]]
tool = "OSINT Framework"
mode_1n = "Monitor online mentions of the facility and key personnel."
mode_2n = "Gather information about employee routines and security procedures."
escalation_level = "script"
kali_package = "N/A"
resource_cost = "low"

# ============================================================================
# GEOSPATIAL INTELLIGENCE (GEE + Weather + Traffic + COMINT)
# ============================================================================
# Location-dependent intelligence requirements and operational factors.
# ============================================================================

[geospatial]
gee_required = true
gee_layers = [
  "USGS/SRTMGL1_003",                        # Elevation (30m resolution)
  "MODIS/006/MCD12Q1",                       # Land cover classification
  "COPERNICUS/S2",                           # Sentinel-2 optical imagery
  "JRC/GSW1_3/GlobalSurfaceWater"            # Water bodies
]

# Distance and time constraints
distance_range = { min_km = 0.5, max_km = 100, optimal_km = 10 }
time_to_target = { min_minutes = 30, max_minutes = 360, optimal_minutes = 60 }

# Terrain factors (affects approach, escape, line-of-sight)
terrain_factors = ["urban_density", "line_of_sight", "elevation", "vegetation_cover"]

# Weather impact (from existing weather_data table)
[geospatial.weather]
critical_factors = ["visibility", "precipitation", "wind_speed", "cloud_cover"]
operational_threshold = { visibility_km = 10.0, wind_speed_ms = 10.0 }
impact_on_surveillance = "Visibility is paramount. Requires clear weather for optimal observation."
impact_on_comms = "Low, but heavy precipitation can impact radio communications."

# Traffic and routing (from pgRouting + PostGIS)
[geospatial.traffic]
road_network_required = true
routing_algorithm = "pgr_dijkstra"           # or pgr_astar, pgr_trsp
cost_factors = ["time_cost", "risk_cost", "slope_cost", "darkness_cost"]
escape_route_priority = "high"
choke_point_analysis = true
traffic_pattern_window = { peak_hours = [7, 9, 16, 19], off_peak_hours = [22, 6] }

# COMINT (Communications Intelligence)
[geospatial.comint]
cell_tower_coverage = true
cell_tower_range_m = 10000
signal_strength_threshold_dbm = -90
imsi_tracking = false                        # 1n: detect adversary, 2n: track target
wifi_mapping = true
wifi_tools = ["wigle", "kismet", "aircrack-ng"]
frequency_bands = ["GSM-900", "GSM-1800", "UMTS-2100", "LTE-700", "LTE-2600", "5G-3500"]

# Critical infrastructure proximity
[geospatial.infrastructure]
critical_assets = ["power_grid", "telecom_hub", "transit_station", "emergency_services"]
proximity_threshold_m = 1000
impact_assessment = "Proximity to critical infrastructure increases risk and necessitates enhanced security measures."

# ============================================================================
# NIEM/N-DEx ONTOLOGICAL MAPPING
# ============================================================================
# Maps CTAS ontology to NIEM IEPDs for law enforcement interoperability.
# ============================================================================

[niem_mapping]
justice_domain = "j:CriminalInvestigation"
intelligence_domain = "intel:SuspiciousActivityReport"
iepd_type = "Incident-Exchange"
iepd_version = "5.2"

# N-DEx field mapping
[niem_mapping.ndex_fields]
incident_category = "Suspicious Activity"
incident_subcategory = "Surveillance"
location_type = "Commercial Facility"
subject_role = "Observer"
activity_type = "Remote Surveillance"

# NIEM core elements
[niem_mapping.niem_core]
"nc:Activity" = "Observation"
"nc:ActivityDate" = "{ collection_phase }"
"nc:Location" = "{ observation_post_location }"
"j:Charge" = "Possible violation of state/federal surveillance laws"

# ============================================================================
# RELATIONSHIPS (Graph Edges)
# ============================================================================
# Defines how this node connects to other nodes in the 165-task graph.
# ============================================================================

[[relationships]]
target_node = "uuid-003-000-000-A"           # Target Selection
relationship_type = "enables"
unicode_op = "‚Üí"                             # Directional flow
strength = 0.85                              # 0.0-1.0 (how critical is this link)
description = "Remote observation directly supports target selection by providing detailed information."

[[relationships]]
target_node = "uuid-010-000-000-A"           # Logistics Planning
relationship_type = "informs"
unicode_op = "‚á¢"
strength = 0.65
description = "Remote observation informs logistics by providing insights into traffic patterns and accessibility."

[[relationships]]
target_node = "uuid-025-000-000-A"           # Counter-Surveillance
relationship_type = "vulnerable_to"
unicode_op = "‚ö†"
strength = 0.70
description = "Remote observation is highly vulnerable to counter-surveillance efforts."

[[relationships]]
target_node = "uuid-037-000-000-A"           # Communications Security
relationship_type = "requires"
unicode_op = "üîó"
strength = 0.50
description = "Remote observation relies on secure communications to transmit collected intelligence."

# ============================================================================
# EEI PRIORITY (Essential Elements of Information)
# ============================================================================
# Ranked intelligence requirements for this task.
# ============================================================================

[[eei_priority]]
rank = 1
question = "What are the ingress/egress points, including loading docks and pedestrian entrances?"
collection_method = "Visual observation, photographic documentation."
time_sensitivity = "high"

[[eei_priority]]
rank = 2
question = "What are the security force deployments, patrol routes, and response times?"
collection_method = "Timed observation, radio frequency monitoring."
time_sensitivity = "high"

[[eei_priority]]
rank = 3
question = "What are the delivery schedules and loading procedures?"
collection_method = "Timed observation, vehicle tracking."
time_sensitivity = "medium"

[[eei_priority]]
rank = 4
question = "What are the communications pathways, including wired and wireless infrastructure?"
collection_method = "Radio frequency scanning, spectrum analysis."
time_sensitivity = "medium"

[[eei_priority]]
rank = 5
question = "What are the building layouts, including ventilation systems and emergency exits?"
collection_method = "Architectural plans, visual observation."
time_sensitivity = "low"

[[eei_priority]]
rank = 6
question = "What are the power and water grid locations and backup systems?"
collection_method = "Utility maps, physical observation."
time_sensitivity = "low"

# ============================================================================
# HISTORICAL REFERENCE (Real-World Examples)
# ============================================================================
# Links to actual incidents where this task was observed.
# ============================================================================

[historical_reference]
incidents = [
  {
    name = "IRA Sniper Operations",
    date = "1970s-1990s",
    description = "Utilized remote observation posts for targeting British security forces.",
    source = "https://www.globalsecurity.org/military/world/para/ira-sniper.htm"
  },
  {
    name = "Hezbollah Operations in Lebanon",
    date = "2006",
    description = "Employed observation posts for monitoring IDF movements and planning attacks.",
    source = "https://www.understandingwar.org/backgrounder/hezbollahs-military-strategy"
  },
  {
    name = "Somali Pirates Maritime Surveillance",
    date = "2008-2012",
    description = "Used coastal observation posts to track shipping lanes and identify targets.",
    source = "https://www.cfr.org/backgrounder/piracy-somalia"
  }
]

# ============================================================================
# TTPS (Tactics, Techniques, and Procedures)
# ============================================================================
# MITRE ATT&CK mapping for cyber TTPs (where applicable).
# ============================================================================

[[ttps]]
mitre_attack_id = "T1592"
tactic = "Reconnaissance"
technique = "Gather Victim Infrastructure Information"
sub_technique = "T1592.004 Hardware"
description = "Collect information on hardware configurations for exploitation."

[[ttps]]
mitre_attack_id = "T1595"
tactic = "Reconnaissance"
technique = "Active Scanning"
sub_technique = "T1595.002 Vulnerability Scanning"
description = "Scan for vulnerabilities to assess attack surface."

[[ttps]]
mitre_attack_id = "T1589"
tactic = "Reconnaissance"
technique = "Gather Victim Identity Information"
sub_technique = "T1589.004 Social Media"
description = "Collect social media information for persona development."

[[ttps]]
mitre_attack_id = "T1591"
tactic = "Reconnaissance"
technique = "Gather Victim Network Information"
sub_technique = "T1591.001 Domain Properties"
description = "Collect network information for path planning."

[[ttps]]
mitre_attack_id = "T1590"
tactic = "Reconnaissance"
technique = "Gather Victim Host Information"
sub_technique = "T1590.002 System Information Discovery"
description = "Discover system information about hosts in target network."

[[ttps]]
mitre_attack_id = "T1620"
tactic = "Reconnaissance"
technique = "Monitor Target Environment"
sub_technique = "N/A"
description = "Ongoing monitoring of target environment through various means."

# ============================================================================
# XSD INTEGRATION (Playbook Orchestration)
# ============================================================================
# Links this node to XSD playbooks for executable document generation.
# ============================================================================

[xsd_integration]
playbook_template = "remote_observation_playbook_v7.3.1.xsd"
crate_orchestration = ["ctas7-foundation-tactical", "ctas7-enhanced-geospatial"]
unicode_assembly = ["‚Üí", "‚á¢", "‚ö†", "üëÅ", "üìç", "üõ∞"]
lisp_expression = "(remote-obs-task :target target-id :phase pre-attack :priority critical)"

# ============================================================================
# METADATA (System Fields)
# ============================================================================

[metadata]
schema_version = "7.3.1"
created_by = "Marcus Chen (Gemini 2M)"
created_at = "2025-03-15T00:00:00Z"
last_updated = "2025-03-15T00:00:00Z"
reviewed_by = "Natasha Volkov"
status = "active"                            # draft | active | deprecated
```