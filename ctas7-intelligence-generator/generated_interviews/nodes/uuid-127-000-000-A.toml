```toml
[node_identity]
task_id = "uuid-127-000-000-A"
task_name = "Task 127 - Phase 4"
classification = "unclassified"
ttl_category = "desirable"

# ============================================================================
# TRIVARIATE HASH (48-position Base96: SCH-CUID-UUID)
# ============================================================================
# Generated via Murmur3 with different seeds for each component.
# Full hash example: "Xk9mP2vL8qR4wN7jT20250109G40N74SU5e8400e29b41d4a"
# ============================================================================

sch = "aBcDeFgHiJkLmNoP"
cuid = "T20241115G34S22Op"
uuid = "QRsTuVwXyZ1aBcD2"

hash_48 = "aBcDeFgHiJkLmNoPT20241115G34S22OpQRsTuVwXyZ1aBcD2"

# ============================================================================
# FIRST-PERSON ADVERSARY NARRATIVE
# ============================================================================
# This is the core intelligence requirement. Written from the adversary's
# perspective, describing capabilities, methods, and intent.
# ============================================================================

[capabilities]
narrative = """
I am the sculptor of chaos, the engineer of disruption. In Phase 4, I weaponize the
intelligence gathered by my predecessors. I develop customized exploits based on
identified vulnerabilities. I fabricate convincing pretexts to bypass security protocols.
I stage my attack vectors, ensuring optimal timing and coordination.

I craft payloads that disable critical systems and sow confusion. I prepare false flags
and disinformation campaigns to misdirect investigators. I rehearse my movements,
accounting for every contingency. I test my tools in simulated environments, refining
their effectiveness.

I am the architect of collapseâ€”I know where to strike, when to strike, and how to
maximize the impact. My purpose is to erode confidence, dismantle defenses, and
pave the way for complete operational success.
"""

limitations = """
I am reliant on the accuracy and completeness of prior intelligence. If my predecessors
missed key vulnerabilities or misidentified critical systems, my attack will falter.
I am vulnerable to active defenses that can detect and neutralize my exploits.
I am susceptible to deception and counter-intelligence operations that can
mislead me.

My success hinges on precise timing and coordination. Any delay or misstep can
expose my plan. I leave traces behind: exploit code, network traffic, behavioral
anomalies. I am at risk of being exposed as soon as the attack commences.
"""

# ============================================================================
# TIME-OF-VALUE (Intelligence Decay)
# ============================================================================
# Defines the actionable window and decay curve for this intelligence type.
# Uses "on the order of" language for human readability + numerical ranges.
# ============================================================================

[time_of_value]
half_life = { words = "hours to days", range = [12, 48], units = "hours" }
collection_phase = { words = "weeks to months before", range = [14, 90], units = "days" }
actionable_window = { words = "hours to days", range = [24, 72], units = "hours" }
decay_curve = "exponential"
ephemeral_conditions = [
  "Vulnerability patches or system updates",
  "Changes in security protocols or configurations",
  "Detection of active exploits",
  "Network segmentation or isolation"
]
persistence_conditions = [
  "Zero-day vulnerabilities",
  "Legacy systems with unpatchable flaws",
  "Misconfigured security settings",
  "Human error or negligence"
]

# ============================================================================
# CONTEXTUAL HASHING (CUID Mask with Environmental Context)
# ============================================================================
# The CUID (positions 17-32) encodes spatio-temporal + semantic + environmental
# context using PREFIX and SUFFIX masks from CTAS 7.3 Ground Truth.
# ============================================================================

[cuid_mask]
# Temporal context
temporal = "T-{14-90}d"
temporal_format = "YYYYMMDD"

# Geographic context
geographic = "G{lat}{lon}"
geographic_radius_km = 1.0

# Semantic domain
semantic = "Op"
semantic_full = "attack:phase_4:weaponization"

# PREFIX MASKS (Global Environmental Context) - Domain-Specific
[cuid_mask.prefix]
# Universal masks (all domains)
WX = "weather_mask"
TF = "traffic_mask"
OB = "order_of_battle_mask"
JU = "jurisdiction_mask"
TH = "threat_posture_mask"

# Domain-Specific Extensions (v7.3)
[cuid_mask.prefix.space]
SR = "solar_radiation"
GM = "geomagnetic_disturbance"
DE = "debris_density"
JS = "jurisdictional_shell"

[cuid_mask.prefix.cyber]
NW = "network_weather"
DT = "data_traffic"
AS = "attack_surface"
FW = "firewall_posture"

[cuid_mask.prefix.maritime]
SS = "sea_state"
CT = "current_tide"
SL = "shipping_lanes"
TW = "territorial_waters"
SC = "submarine_cables"
PT = "port_traffic"

[cuid_mask.prefix.network]
TP = "topology"
RT = "routing"
LT = "latency"
PL = "packet_loss"
BU = "bandwidth_utilization"
AS = "autonomous_system"

# SUFFIX MASKS (Local Operational Context)
[cuid_mask.suffix]
RP = "personnel_availability"
RE = "equipment_readiness"
RS = "supplies_availability"
BW = "bandwidth_comms"
RO = "rules_of_engagement"

# Priority
priority = "critical"

# ============================================================================
# HD4 TACTICAL MAPPING
# ============================================================================
# Maps this node to the 5 phases of the HD4 kill chain.
# ============================================================================

[hd4_phases]
hunt = { enabled = false, priority = "low", description = "Not applicable for attack phase" }
detect = { enabled = true, priority = "critical", description = "Detect active exploits and intrusions" }
disrupt = { enabled = true, priority = "high", description = "Neutralize attack vectors and limit impact" }
disable = { enabled = true, priority = "critical", description = "Disable compromised systems and restore functionality" }
dominate = { enabled = true, priority = "medium", description = "Establish control and maintain operational superiority" }

# ============================================================================
# INDICATORS (Observable Signatures)
# ============================================================================
# Key indicators that this task is occurring. Used for detection and hunting.
# ============================================================================

[[indicators]]
observable = "Exploit code execution on critical systems"
priority = "critical"
detection_method = "Endpoint detection and response (EDR), intrusion detection systems (IDS)"
false_positive_rate = "low"

[[indicators]]
observable = "Privilege escalation attempts"
priority = "critical"
detection_method = "Security information and event management (SIEM), host-based intrusion detection systems (HIDS)"
false_positive_rate = "medium"

[[indicators]]
observable = "Lateral movement within the network"
priority = "high"
detection_method = "Network traffic analysis, firewall logs"
false_positive_rate = "medium"

[[indicators]]
observable = "Data exfiltration to unauthorized locations"
priority = "critical"
detection_method = "Data loss prevention (DLP), network monitoring"
false_positive_rate = "low"

[[indicators]]
observable = "System instability or crashes"
priority = "medium"
detection_method = "System logs, performance monitoring"
false_positive_rate = "high"

[[indicators]]
observable = "Anomalous network traffic patterns"
priority = "high"
detection_method = "NetFlow analysis, deep packet inspection (DPI)"
false_positive_rate = "medium"

[[indicators]]
observable = "Compromised user accounts"
priority = "critical"
detection_method = "Account monitoring, multi-factor authentication (MFA) logs"
false_positive_rate = "low"

[[indicators]]
observable = "Unusual scheduled tasks or services"
priority = "medium"
detection_method = "System configuration monitoring, endpoint security agents"
false_positive_rate = "medium"

[[indicators]]
observable = "Malicious file uploads or downloads"
priority = "high"
detection_method = "Web proxy logs, sandbox analysis"
false_positive_rate = "medium"

[[indicators]]
observable = "Unexpected changes to critical files or registries"
priority = "high"
detection_method = "File integrity monitoring (FIM), host-based intrusion detection systems (HIDS)"
false_positive_rate = "medium"

# ============================================================================
# TOOLCHAIN (1n Defensive + 2n Offensive)
# ============================================================================
# Dual-mode tool stacks: same tools, different semantic context.
# ============================================================================

[[toolchain]]
tool = "Metasploit"
mode_1n = "Test and validate security vulnerabilities"
mode_2n = "Exploit identified vulnerabilities to gain access"
escalation_level = "crate"
kali_package = "metasploit-framework"
resource_cost = "medium"

[[toolchain]]
tool = "Nmap"
mode_1n = "Identify open ports and services for vulnerability scanning"
mode_2n = "Map the network and identify potential attack vectors"
escalation_level = "script"
kali_package = "nmap"
resource_cost = "low"

[[toolchain]]
tool = "Wireshark"
mode_1n = "Analyze network traffic for suspicious activity"
mode_2n = "Capture network traffic to analyze credentials and data"
escalation_level = "microkernel"
kali_package = "wireshark"
resource_cost = "low"

[[toolchain]]
tool = "Mimikatz"
mode_1n = "Detect and mitigate credential theft attempts"
mode_2n = "Extract credentials from memory for lateral movement"
escalation_level = "microkernel"
kali_package = "mimikatz"
resource_cost = "low"

[[toolchain]]
tool = "PowerShell Empire"
mode_1n = "Detect and analyze PowerShell-based attacks"
mode_2n = "Leverage PowerShell for post-exploitation activities"
escalation_level = "crate"
kali_package = "powershell-empire"
resource_cost = "medium"

[[toolchain]]
tool = "Burp Suite"
mode_1n = "Test web application security and identify vulnerabilities"
mode_2n = "Exploit web application vulnerabilities to gain access"
escalation_level = "crate"
kali_package = "burpsuite"
resource_cost = "medium"

# ============================================================================
# GEOSPATIAL INTELLIGENCE (GEE + Weather + Traffic + COMINT)
# ============================================================================
# Location-dependent intelligence requirements and operational factors.
# ============================================================================

[geospatial]
gee_required = false
gee_layers = []

# Distance and time constraints
distance_range = { min_km = 0.1, max_km = 10, optimal_km = 1 }
time_to_target = { min_minutes = 1, max_minutes = 60, optimal_minutes = 5 }

# Terrain factors (affects approach, escape, line-of-sight)
terrain_factors = []

# Weather impact (from existing weather_data table)
[geospatial.weather]
critical_factors = []
operational_threshold = {}
impact_on_surveillance = "N/A"
impact_on_comms = "N/A"

# Traffic and routing (from pgRouting + PostGIS)
[geospatial.traffic]
road_network_required = false
routing_algorithm = "N/A"
cost_factors = []
escape_route_priority = "N/A"
choke_point_analysis = false
traffic_pattern_window = {}

# COMINT (Communications Intelligence)
[geospatial.comint]
cell_tower_coverage = false
cell_tower_range_m = 0
signal_strength_threshold_dbm = 0
imsi_tracking = false
wifi_mapping = false
wifi_tools = []
frequency_bands = []

# Critical infrastructure proximity
[geospatial.infrastructure]
critical_assets = []
proximity_threshold_m = 0
impact_assessment = "N/A"

# ============================================================================
# NIEM/N-DEx ONTOLOGICAL MAPPING
# ============================================================================
# Maps CTAS ontology to NIEM IEPDs for law enforcement interoperability.
# ============================================================================

[niem_mapping]
justice_domain = "j:CyberCrime"
intelligence_domain = "intel:CyberAttackReport"
iepd_type = "Incident-Exchange"
iepd_version = "5.2"

# N-DEx field mapping
[niem_mapping.ndex_fields]
incident_category = "Cyber Attack"
incident_subcategory = "Exploitation"
location_type = "Network Infrastructure"
subject_role = "Attacker"
activity_type = "Post-Exploitation"

# NIEM core elements
[niem_mapping.niem_core]
"nc:Activity" = "Exploitation"
"nc:ActivityDate" = "{ actionable_window }"
"nc:Location" = "{ target_network }"
"j:Charge" = "18 USC 1030 (Computer Fraud and Abuse Act)"

# ============================================================================
# RELATIONSHIPS (Graph Edges)
# ============================================================================
# Defines how this node connects to other nodes in the 165-task graph.
# ============================================================================

[[relationships]]
target_node = "uuid-130-000-000-A"
relationship_type = "precedes"
unicode_op = "â†’"
strength = 0.90
description = "Exploitation precedes system compromise"

[[relationships]]
target_node = "uuid-140-000-000-A"
relationship_type = "results_in"
unicode_op = "â‡¢"
strength = 0.80
description = "Exploitation results in data breach"

[[relationships]]
target_node = "uuid-020-000-000-A"
relationship_type = "dependent_on"
unicode_op = "âš "
strength = 0.70
description = "Exploitation dependent on target vulnerabilities"

# ============================================================================
# EEI PRIORITY (Essential Elements of Information)
# ============================================================================
# Ranked intelligence requirements for this task.
# ============================================================================

[[eei_priority]]
rank = 1
question = "What are the exploitable vulnerabilities in target systems?"
collection_method = "Vulnerability scans, penetration tests, exploit research"
time_sensitivity = "critical"

[[eei_priority]]
rank = 2
question = "What are the credentials for critical accounts?"
collection_method = "Credential harvesting, phishing, social engineering"
time_sensitivity = "high"

[[eei_priority]]
rank = 3
question = "What are the network configurations and access controls?"
collection_method = "Network mapping, configuration audits, traffic analysis"
time_sensitivity = "medium"

[[eei_priority]]
rank = 4
question = "What are the security controls in place?"
collection_method = "Security assessments, policy reviews, system audits"
time_sensitivity = "medium"

[[eei_priority]]
rank = 5
question = "What are the detection capabilities of the target organization?"
collection_method = "Red team exercises, incident response simulations, threat intelligence"
time_sensitivity = "low"

# ============================================================================
# HISTORICAL REFERENCE (Real-World Examples)
# ============================================================================
# Links to actual incidents where this task was observed.
# ============================================================================

[historical_reference]
incidents = [
  {
    name = "NotPetya Attack",
    date = "2017-06-27",
    description = "Exploitation of EternalBlue vulnerability to spread ransomware",
    source = "https://www.wired.com/story/notpetya-cyberattack-ukraine-russia-code-crashed-world/"
  },
  {
    name = "Equifax Data Breach",
    date = "2017-07-29",
    description = "Exploitation of Apache Struts vulnerability to steal sensitive data",
    source = "https://www.ftc.gov/news-events/press-releases/2019/07/equifax-pay-least-575-million-settlement-federal-state-agencies"
  },
  {
    name = "WannaCry Ransomware Attack",
    date = "2017-05-12",
    description = "Exploitation of EternalBlue vulnerability to encrypt and ransom data",
    source = "https://www.justice.gov/opa/pr/north-korean-regime-charged-conspiracy-commit-multiple-cyberattacks-and-intrusions"
  }
]

# ============================================================================
# TTPS (Tactics, Techniques, and Procedures)
# ============================================================================
# MITRE ATT&CK mapping for cyber TTPs (where applicable).
# ============================================================================

[[ttps]]
mitre_attack_id = "T1190"
tactic = "Initial Access"
technique = "Exploit Public-Facing Application"
sub_technique = ""
description = "Exploit vulnerabilities in public-facing applications to gain initial access"

[[ttps]]
mitre_attack_id = "T1068"
tactic = "Privilege Escalation"
technique = "Exploitation for Privilege Escalation"
sub_technique = ""
description = "Exploit vulnerabilities to escalate privileges"

[[ttps]]
mitre_attack_id = "T1213"
tactic = "Collection"
technique = "Data from Information Repositories"
sub_technique = "T1213.002 - Sharepoint"
description = "Collect data from Sharepoint"

[[ttps]]
mitre_attack_id = "T1059"
tactic = "Execution"
technique = "Command and Scripting Interpreter"
sub_technique = "T1059.001 - PowerShell"
description = "Use PowerShell to execute commands and scripts"

[[ttps]]
mitre_attack_id = "T1071"
tactic = "Command and Control"
technique = "Application Layer Protocol"
sub_technique = "T1071.001 - Web Protocols"
description = "Use web protocols for command and control"

[[ttps]]
mitre_attack_id = "T1027"
tactic = "Defense Evasion"
technique = "Obfuscated Files or Information"
sub_technique = ""
description = "Obfuscate files or information to evade detection"

[[ttps]]
mitre_attack_id = "T1567"
tactic = "Exfiltration"
technique = "Exfiltration Over Web Service"
sub_technique = "T1567.002 - Exfiltration to Cloud Storage"
description = "Exfiltrate data to cloud storage services"

# ============================================================================
# XSD INTEGRATION (Playbook Orchestration)
# ============================================================================
# Links this node to XSD playbooks for executable document generation.
# ============================================================================

[xsd_integration]
playbook_template = "attack_phase_4_playbook_v7.3.1.xsd"
crate_orchestration = ["ctas7-enhanced-exploitation", "ctas7-advanced-persistence"]
unicode_assembly = ["â†’", "â‡¢", "âš ", "ðŸ’¥", "ðŸ”¥", "ðŸ’£"]
lisp_expression = "(attack-task :target target-id :phase exploitation :priority critical)"

# ============================================================================
# METADATA (System Fields)
# ============================================================================

[metadata]
schema_version = "7.3.1"
created_by = "Marcus Chen (Gemini 2M)"
created_at = "2025-01-09T00:00:00Z"
last_updated = "2025-01-09T00:00:00Z"
reviewed_by = "Natasha Volkov"
status = "active"
```