```toml
[node_identity]
task_id = "uuid-056-000-000-A"
task_name = "Task 56 - Phase 2"
classification = "unclassified"
ttl_category = "mandatory"

# ============================================================================
# TRIVARIATE HASH (48-position Base96: SCH-CUID-UUID)
# ============================================================================
# Generated via Murmur3 with different seeds for each component.
# Full hash example: "Xk9mP2vL8qR4wN7jT20250109G40N74SU5e8400e29b41d4a"
# ============================================================================

sch = "a3KmL79p2Qs5Wx4d"
cuid = "T20250315G12W96Sw"
uuid = "zY1b8x2Uc5a9T4r0"

hash_48 = "a3KmL79p2Qs5Wx4dT20250315G12W96SwzY1b8x2Uc5a9T4r0"

# ============================================================================
# FIRST-PERSON ADVERSARY NARRATIVE
# ============================================================================
# This is the core intelligence requirement. Written from the adversary's
# perspective, describing capabilities, methods, and intent.
# ============================================================================

[capabilities]
narrative = """
I'm the shadow that watches before the strike. I've moved past simple observation;
now I'm probing for weaknesses. I test physical security by attempting to bypass fences,
exploiting unlocked doors during delivery windows, and disabling exterior cameras with
directional EMP jammers. I plant covert listening devices in areas where security
plans are discussed.

I delve deeper into the digital realm. I compromise printers and network-connected
thermostats to gain persistent access. I scan for rogue access points masquerading
as legitimate networks. I use keyloggers on public-facing terminals to capture login
credentials. I identify vulnerable VPN entry points.

I monitor internal communication channels for operational details and potential
insider threats or disgruntled employees. I am escalating the reconnaissance phase.
My objective is to identify concrete exploitable pathways and gather intelligence
necessary for gaining unauthorized access and control.
"""

limitations = """
My actions increase the risk of detection exponentially. Physical probes leave
traces, and EMP jammers can be detected. Compromising devices requires
vulnerabilities that may be patched or trigger alarms. Internal network monitoring
risks immediate exposure and requires highly sophisticated techniques to remain
undetected.

Advanced security systems with intrusion detection and prevention mechanisms
present significant obstacles. The presence of a strong security operations center
(SOC) with proactive threat hunting capabilities makes it extremely difficult to
operate without raising suspicion. Insider threats are unpredictable and unreliable.
"""

# ============================================================================
# TIME-OF-VALUE (Intelligence Decay)
# ============================================================================
# Defines the actionable window and decay curve for this intelligence type.
# Uses "on the order of" language for human readability + numerical ranges.
# ============================================================================

[time_of_value]
half_life = { words = "days to weeks", range = [3, 14], units = "days" }
collection_phase = { words = "weeks before", range = [2, 8], units = "weeks" }
actionable_window = { words = "weeks", range = [1, 4], units = "weeks" }
decay_curve = "exponential"
ephemeral_conditions = [
  "Security system upgrades and patching",
  "Network configuration changes",
  "Password rotations",
  "Incident response activities",
  "Detection of rogue devices"
]
persistence_conditions = [
  "Underlying network infrastructure",
  "Default configurations",
  "Unpatched legacy systems",
  "Physical layout of the facility"
]

# ============================================================================
# CONTEXTUAL HASHING (CUID Mask with Environmental Context)
# ============================================================================
# The CUID (positions 17-32) encodes spatio-temporal + semantic + environmental
# context using PREFIX and SUFFIX masks from CTAS 7.3 Ground Truth.
# ============================================================================

[cuid_mask]
# Temporal context
temporal = "T-{14-56}d"
temporal_format = "YYYYMMDD"

# Geographic context
geographic = "G{lat}{lon}"
geographic_radius_km = 2.0

# Semantic domain
semantic = "Sw"
semantic_full = "recon:physical:vulnerability_assessment"

# PREFIX MASKS (Global Environmental Context) - Domain-Specific
[cuid_mask.prefix]
# Universal masks (all domains)
WX = "weather_mask"
TF = "traffic_mask"
OB = "order_of_battle_mask"
JU = "jurisdiction_mask"
TH = "threat_posture_mask"

# Domain-Specific Extensions (v7.3)
[cuid_mask.prefix.space]
SR = "solar_radiation"
GM = "geomagnetic_disturbance"
DE = "debris_density"
JS = "jurisdictional_shell"

[cuid_mask.prefix.cyber]
NW = "network_weather"
DT = "data_traffic"
AS = "attack_surface"
FW = "firewall_posture"

[cuid_mask.prefix.maritime]
SS = "sea_state"
CT = "current_tide"
SL = "shipping_lanes"
TW = "territorial_waters"
SC = "submarine_cables"
PT = "port_traffic"

[cuid_mask.prefix.network]
TP = "topology"
RT = "routing"
LT = "latency"
PL = "packet_loss"
BU = "bandwidth_utilization"
AS = "autonomous_system"

# SUFFIX MASKS (Local Operational Context)
[cuid_mask.suffix]
RP = "personnel_availability"
RE = "equipment_readiness"
RS = "supplies_availability"
BW = "bandwidth_comms"
RO = "rules_of_engagement"

# Priority
priority = "high"

# ============================================================================
# HD4 TACTICAL MAPPING
# ============================================================================
# Maps this node to the 5 phases of the HD4 kill chain.
# ============================================================================

[hd4_phases]
hunt = { enabled = true, priority = "high", description = "Proactive search for advanced reconnaissance patterns" }
detect = { enabled = true, priority = "critical", description = "Real-time identification of intrusion attempts" }
disrupt = { enabled = true, priority = "medium", description = "Counter-surveillance and deception operations" }
disable = { enabled = true, priority = "medium", description = "Neutralize compromised systems and devices" }
dominate = { enabled = false, priority = "low", description = "Not directly applicable" }

# ============================================================================
# INDICATORS (Observable Signatures)
# ============================================================================
# Key indicators that this task is occurring. Used for detection and hunting.
# ============================================================================

[[indicators]]
observable = "Attempted physical intrusion attempts (bypassing fences, doors)"
priority = "critical"
detection_method = "Perimeter sensors, alarm systems, security guard patrols"
false_positive_rate = "low"

[[indicators]]
observable = "Unauthorized network scans and probes"
priority = "high"
detection_method = "Intrusion Detection Systems (IDS), firewall logs"
false_positive_rate = "medium"

[[indicators]]
observable = "Detection of rogue wireless access points"
priority = "critical"
detection_method = "Wireless Intrusion Detection Systems (WIDS)"
false_positive_rate = "low"

[[indicators]]
observable = "Compromised IoT devices on the network"
priority = "high"
detection_method = "Network traffic analysis, endpoint detection and response (EDR)"
false_positive_rate = "medium"

[[indicators]]
observable = "Internal network traffic anomalies"
priority = "medium"
detection_method = "Network flow analysis, User and Entity Behavior Analytics (UEBA)"
false_positive_rate = "high"

[[indicators]]
observable = "Placement of covert listening devices"
priority = "critical"
detection_method = "Physical security sweeps, RF spectrum analysis"
false_positive_rate = "low"

[[indicators]]
observable = "Exploitation of printers or other network devices"
priority = "high"
detection_method = "Log analysis, device monitoring, vulnerability scans"
false_positive_rate = "medium"

[[indicators]]
observable = "Scanning for vulnerable VPN entry points"
priority = "critical"
detection_method = "VPN log analysis, security information and event management (SIEM)"
false_positive_rate = "low"

[[indicators]]
observable = "Unusual access patterns to sensitive internal documents"
priority = "high"
detection_method = "Data Loss Prevention (DLP), access control logs"
false_positive_rate = "medium"

[[indicators]]
observable = "Monitoring of internal communication channels"
priority = "critical"
detection_method = "Anomaly detection, keyword analysis, behavioral analysis"
false_positive_rate = "low"

# ============================================================================
# TOOLCHAIN (1n Defensive + 2n Offensive)
# ============================================================================
# Dual-mode tool stacks: same tools, different semantic context.
# ============================================================================

[[toolchain]]
tool = "Nmap"
mode_1n = "Scan network for open ports and vulnerable services"
mode_2n = "Identify exploitable weaknesses in target infrastructure"
escalation_level = "script"
kali_package = "nmap"
resource_cost = "low"

[[toolchain]]
tool = "Metasploit"
mode_1n = "Validate and patch known vulnerabilities"
mode_2n = "Exploit identified vulnerabilities to gain access"
escalation_level = "crate"
kali_package = "metasploit-framework"
resource_cost = "high"

[[toolchain]]
tool = "Wireshark"
mode_1n = "Analyze network traffic for malicious activity"
mode_2n = "Capture and analyze network traffic to uncover sensitive information"
escalation_level = "script"
kali_package = "wireshark"
resource_cost = "low"

[[toolchain]]
tool = "Aircrack-ng"
mode_1n = "Audit wireless network security and identify vulnerabilities"
mode_2n = "Crack WEP/WPA keys to gain unauthorized network access"
escalation_level = "microkernel"
kali_package = "aircrack-ng"
resource_cost = "medium"

[[toolchain]]
tool = "Burp Suite"
mode_1n = "Assess web application security vulnerabilities"
mode_2n = "Exploit web application flaws for data exfiltration and system compromise"
escalation_level = "crate"
kali_package = "burpsuite"
resource_cost = "medium"

[[toolchain]]
tool = "Responder"
mode_1n = "Detect and mitigate LLMNR/NBT-NS poisoning attacks"
mode_2n = "Capture network credentials through LLMNR/NBT-NS poisoning"
escalation_level = "script"
kali_package = "responder"
resource_cost = "low"

# ============================================================================
# GEOSPATIAL INTELLIGENCE (GEE + Weather + Traffic + COMINT)
# ============================================================================
# Location-dependent intelligence requirements and operational factors.
# ============================================================================

[geospatial]
gee_required = true
gee_layers = [
  "USGS/SRTMGL1_003",
  "MODIS/006/MCD12Q1",
  "COPERNICUS/S2",
  "JRC/GSW1_3/GlobalSurfaceWater"
]

# Distance and time constraints
distance_range = { min_km = 0.1, max_km = 10, optimal_km = 1 }
time_to_target = { min_minutes = 5, max_minutes = 60, optimal_minutes = 20 }

# Terrain factors (affects approach, escape, line-of-sight)
terrain_factors = ["urban_density", "line_of_sight", "elevation", "vegetation_cover"]

# Weather impact (from existing weather_data table)
[geospatial.weather]
critical_factors = ["visibility", "precipitation", "wind_speed", "temperature"]
operational_threshold = { visibility_km = 2.0, wind_speed_ms = 10.0 }
impact_on_surveillance = "Adverse weather restricts physical intrusion attempts"
impact_on_comms = "Weather can impact wireless signal integrity"

# Traffic and routing (from pgRouting + PostGIS)
[geospatial.traffic]
road_network_required = true
routing_algorithm = "pgr_dijkstra"
cost_factors = ["time_cost", "risk_cost", "slope_cost", "darkness_cost"]
escape_route_priority = "high"
choke_point_analysis = true
traffic_pattern_window = { peak_hours = [7, 9, 16, 19], off_peak_hours = [22, 6] }

# COMINT (Communications Intelligence)
[geospatial.comint]
cell_tower_coverage = true
cell_tower_range_m = 2000
signal_strength_threshold_dbm = -85
imsi_tracking = true
wifi_mapping = true
wifi_tools = ["wigle", "kismet", "aircrack-ng"]
frequency_bands = ["GSM-900", "GSM-1800", "UMTS-2100", "LTE-700", "LTE-2600", "5G-3500"]

# Critical infrastructure proximity
[geospatial.infrastructure]
critical_assets = ["power_grid", "telecom_hub", "transit_station", "emergency_services"]
proximity_threshold_m = 250
impact_assessment = "Proximity to critical infrastructure presents cascading risks"

# ============================================================================
# NIEM/N-DEx ONTOLOGICAL MAPPING
# ============================================================================
# Maps CTAS ontology to NIEM IEPDs for law enforcement interoperability.
# ============================================================================

[niem_mapping]
justice_domain = "j:CriminalInvestigation"
intelligence_domain = "intel:SuspiciousActivityReport"
iepd_type = "Incident-Exchange"
iepd_version = "5.2"

# N-DEx field mapping
[niem_mapping.ndex_fields]
incident_category = "Suspicious Activity"
incident_subcategory = "Network Intrusion"
location_type = "Commercial Facility"
subject_role = "Suspect"
activity_type = "Advanced Reconnaissance"

# NIEM core elements
[niem_mapping.niem_core]
"nc:Activity" = "Vulnerability Probing"
"nc:ActivityDate" = "{ collection_phase }"
"nc:Location" = "{ target_location }"
"j:Charge" = "18 USC 1030 (Computer Fraud and Abuse Act)"

# ============================================================================
# RELATIONSHIPS (Graph Edges)
# ============================================================================
# Defines how this node connects to other nodes in the 165-task graph.
# ============================================================================

[[relationships]]
target_node = "uuid-057-000-000-A"
relationship_type = "enables"
unicode_op = "‚Üí"
strength = 0.9
description = "Phase 2 directly enables exploitation planning"

[[relationships]]
target_node = "uuid-060-000-000-A"
relationship_type = "informs"
unicode_op = "‚á¢"
strength = 0.8
description = "Phase 2 informs resource allocation for attack"

[[relationships]]
target_node = "uuid-025-000-000-A"
relationship_type = "vulnerable_to"
unicode_op = "‚ö†"
strength = 0.7
description = "Advanced reconnaissance vulnerable to sophisticated detection"

# ============================================================================
# EEI PRIORITY (Essential Elements of Information)
# ============================================================================
# Ranked intelligence requirements for this task.
# ============================================================================

[[eei_priority]]
rank = 1
question = "What exploitable vulnerabilities exist within the target network?"
collection_method = "Network scanning, vulnerability assessment"
time_sensitivity = "critical"

[[eei_priority]]
rank = 2
question = "What are the weak points in the physical security infrastructure?"
collection_method = "Physical probing, sensor analysis"
time_sensitivity = "high"

[[eei_priority]]
rank = 3
question = "What internal communication channels can be monitored?"
collection_method = "Network sniffing, covert listening devices"
time_sensitivity = "high"

[[eei_priority]]
rank = 4
question = "Which IoT devices are vulnerable to compromise?"
collection_method = "Device identification, vulnerability scanning"
time_sensitivity = "medium"

[[eei_priority]]
rank = 5
question = "What are the VPN entry points and their security posture?"
collection_method = "VPN scanning, credential harvesting"
time_sensitivity = "critical"

# ============================================================================
# HISTORICAL REFERENCE (Real-World Examples)
# ============================================================================
# Links to actual incidents where this task was observed.
# ============================================================================

[historical_reference]
incidents = [
  {
    name = "Target Data Breach",
    date = "2013-12-01",
    description = "Exploitation of HVAC system for initial access.",
    source = "https://en.wikipedia.org/wiki/Target_data_breach"
  },
  {
    name = "Stuxnet Worm",
    date = "2010-06-01",
    description = "Advanced reconnaissance of Iranian nuclear facilities' network architecture.",
    source = "https://en.wikipedia.org/wiki/Stuxnet"
  },
  {
    name = "SolarWinds Supply Chain Attack",
    date = "2020-12-01",
    description = "Compromise of software build and release systems.",
    source = "https://en.wikipedia.org/wiki/SolarWinds_supply_chain_attack"
  }
]

# ============================================================================
# TTPS (Tactics, Techniques, and Procedures)
# ============================================================================
# MITRE ATT&CK mapping for cyber TTPs (where applicable).
# ============================================================================

[[ttps]]
mitre_attack_id = "T1595"
tactic = "Reconnaissance"
technique = "Active Scanning"
sub_technique = "T1595.002 - Vulnerability Scanning"
description = "Adversary performs vulnerability scanning to identify exploitable weaknesses."

[[ttps]]
mitre_attack_id = "T1190"
tactic = "Initial Access"
technique = "Exploit Public-Facing Application"
description = "Adversary exploits a publicly accessible application to gain initial access."

[[ttps]]
mitre_attack_id = "T1078"
tactic = "Defense Evasion"
technique = "Valid Accounts"
sub_technique = "T1078.001 - Default Accounts"
description = "Adversary uses default credentials to gain access."

[[ttps]]
mitre_attack_id = "T1059"
tactic = "Execution"
technique = "Command and Scripting Interpreter"
sub_technique = "T1059.003 - Windows Command Shell"
description = "Adversary uses command-line interface for execution."

[[ttps]]
mitre_attack_id = "T1204"
tactic = "Execution"
technique = "User Execution"
sub_technique = "T1204.002 - Malicious File"
description = "Adversary lures user to execute malicious file."

[[ttps]]
mitre_attack_id = "T1550"
tactic = "Lateral Movement"
technique = "Use Alternate Authentication Material"
sub_technique = "T1550.002 - Pass the Hash"
description = "Adversary uses captured credentials to move laterally."

# ============================================================================
# XSD INTEGRATION (Playbook Orchestration)
# ============================================================================
# Links this node to XSD playbooks for executable document generation.
# ============================================================================

[xsd_integration]
playbook_template = "advanced_reconnaissance_playbook_v7.3.1.xsd"
crate_orchestration = ["ctas7-advanced-exploitation", "ctas7-network-intrusion"]
unicode_assembly = ["‚Üí", "‚á¢", "‚ö†", "üëÅ", "üìç", "üõ∞"]
lisp_expression = "(advanced-recon-task :target target-id :phase pre-attack :priority critical)"

# ============================================================================
# METADATA (System Fields)
# ============================================================================

[metadata]
schema_version = "7.3.1"
created_by = "Marcus Chen (Gemini 2M)"
created_at = "2025-03-15T00:00:00Z"
last_updated = "2025-03-15T00:00:00Z"
reviewed_by = "Natasha Volkov"
status = "active"
```