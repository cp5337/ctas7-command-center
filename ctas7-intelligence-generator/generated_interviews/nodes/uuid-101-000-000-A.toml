```toml
[node_identity]
task_id = "uuid-101-000-000-A"
task_name = "Task 101 - Phase 3"
classification = "unclassified"
ttl_category = "desirable"

# ============================================================================
# TRIVARIATE HASH (48-position Base96: SCH-CUID-UUID)
# ============================================================================
# Generated via Murmur3 with different seeds for each component.
# Full hash example: "Xk9mP2vL8qR4wN7jT20250109G40N74SU5e8400e29b41d4a"
# ============================================================================

sch = "aBcDeFgHiJkLmNoP"
cuid = "T20250315G34S89Sg"
uuid = "aBcDeFgHiJkLmNoP"
hash_48 = "aBcDeFgHiJkLmNoPT20250315G34S89SgaBcDeFgHiJkLmNoP"

# ============================================================================
# FIRST-PERSON ADVERSARY NARRATIVE
# ============================================================================
# This is the core intelligence requirement. Written from the adversary's
# perspective, describing capabilities, methods, and intent.
# ============================================================================

[capabilities]
narrative = """
I am the silent observer, the phantom in the machine. My purpose is to understand the workings of the target, its defenses, its vulnerabilities, before the first shot is fired. I delve into the digital realm, mapping network topologies, identifying open ports, sniffing traffic for weaknesses.

I explore the physical world, using drones equipped with thermal cameras to identify heat signatures and potential access points. I analyze security protocols, looking for gaps in coverage or predictable routines. I exploit social engineering to gather information from employees, learning about their habits, their access privileges, their vulnerabilities.

I am not interested in immediate gratification. My work is patient, methodical, comprehensive. I am building a complete picture of the target, a detailed map of its strengths and weaknesses. With this knowledge, the attack will be swift, precise, and devastating. I am the key to victory.
"""

limitations = """
I am constrained by my reliance on technology. Firewalls and intrusion detection systems can detect my scanning activities. Antivirus software can identify my malware. Security cameras and physical guards can deter my surveillance. I am also limited by my own skills and resources. I must be careful not to leave a digital trail or draw attention to myself.

My effectiveness degrades over time as security measures are updated and new vulnerabilities are discovered. I am vulnerable to counter-intelligence efforts, which can detect my activities and lead to my capture. I must constantly adapt and evolve to stay ahead of the curve.
"""

# ============================================================================
# TIME-OF-VALUE (Intelligence Decay)
# ============================================================================
# Defines the actionable window and decay curve for this intelligence type.
# Uses "on the order of" language for human readability + numerical ranges.
# ============================================================================

[time_of_value]
half_life = { words = "weeks to months", range = [14, 60], units = "days" }
collection_phase = { words = "months", range = [3, 9], units = "months" }
actionable_window = { words = "months to years", range = [3, 12], units = "months" }
decay_curve = "exponential"
ephemeral_conditions = [
  "Network infrastructure changes (new firewalls, intrusion detection systems)",
  "Software updates and patch deployments",
  "Employee training and awareness programs",
  "Physical security enhancements (new cameras, guards, protocols)"
]
persistence_conditions = [
  "Underlying network infrastructure",
  "Organizational culture and security practices",
  "Physical building layout and access points",
  "Legacy systems and unpatched vulnerabilities"
]

# ============================================================================
# CONTEXTUAL HASHING (CUID Mask with Environmental Context)
# ============================================================================
# The CUID (positions 17-32) encodes spatio-temporal + semantic + environmental
# context using PREFIX and SUFFIX masks from CTAS 7.3 Ground Truth.
# ============================================================================

[cuid_mask]
# Temporal context
temporal = "T-{90-270}d"
temporal_format = "YYYYMMDD"

# Geographic context
geographic = "G{lat}{lon}"
geographic_radius_km = 2.0

# Semantic domain
semantic = "Sg"
semantic_full = "recon:cyber:infrastructure"

# PREFIX MASKS (Global Environmental Context) - Domain-Specific
[cuid_mask.prefix]
# Universal masks (all domains)
WX = "weather_mask"
TF = "traffic_mask"
OB = "order_of_battle_mask"
JU = "jurisdiction_mask"
TH = "threat_posture_mask"

# Domain-Specific Extensions (v7.3)
[cuid_mask.prefix.space]
SR = "solar_radiation"
GM = "geomagnetic_disturbance"
DE = "debris_density"
JS = "jurisdictional_shell"

[cuid_mask.prefix.cyber]
NW = "network_weather"
DT = "data_traffic"
AS = "attack_surface"
FW = "firewall_posture"

[cuid_mask.prefix.maritime]
SS = "sea_state"
CT = "current_tide"
SL = "shipping_lanes"
TW = "territorial_waters"
SC = "submarine_cables"
PT = "port_traffic"

[cuid_mask.prefix.network]
TP = "topology"
RT = "routing"
LT = "latency"
PL = "packet_loss"
BU = "bandwidth_utilization"
AS = "autonomous_system"

# SUFFIX MASKS (Local Operational Context)
[cuid_mask.suffix]
RP = "personnel_availability"
RE = "equipment_readiness"
RS = "supplies_availability"
BW = "bandwidth_comms"
RO = "rules_of_engagement"

# Priority
priority = "high"

# ============================================================================
# HD4 TACTICAL MAPPING
# ============================================================================
# Maps this node to the 5 phases of the HD4 kill chain.
# ============================================================================

[hd4_phases]
hunt = { enabled = true, priority = "high", description = "Proactive search for indicators of compromise and attack preparation." }
detect = { enabled = true, priority = "critical", description = "Detect anomalous network activity and system behavior." }
disrupt = { enabled = true, priority = "medium", description = "Implement countermeasures to disrupt attack preparations and prevent exploitation." }
disable = { enabled = false, priority = "low", description = "Not applicable for information gathering." }
dominate = { enabled = false, priority = "low", description = "Not applicable for information gathering." }

# ============================================================================
# INDICATORS (Observable Signatures)
# ============================================================================
# Key indicators that this task is occurring. Used for detection and hunting.
# ============================================================================

[[indicators]]
observable = "Unusual network scanning activity"
priority = "critical"
detection_method = "Intrusion detection systems, network traffic analysis"
false_positive_rate = "low"

[[indicators]]
observable = "Unauthorized access attempts to sensitive systems"
priority = "critical"
detection_method = "Security logs, access control systems"
false_positive_rate = "low"

[[indicators]]
observable = "Suspicious file uploads or downloads"
priority = "high"
detection_method = "Data loss prevention systems, network traffic analysis"
false_positive_rate = "medium"

[[indicators]]
observable = "Anomalous system behavior (e.g., unexpected process execution)"
priority = "high"
detection_method = "Endpoint detection and response systems, security logs"
false_positive_rate = "medium"

[[indicators]]
observable = "Phishing emails targeting employees with privileged access"
priority = "critical"
detection_method = "Email security gateways, user reports"
false_positive_rate = "low"

[[indicators]]
observable = "Credential dumping or password spraying attacks"
priority = "critical"
detection_method = "Active Directory monitoring, security logs"
false_positive_rate = "low"

[[indicators]]
observable = "Reconnaissance of internal documentation and network diagrams"
priority = "high"
detection_method = "Access control monitoring, data loss prevention systems"
false_positive_rate = "medium"

[[indicators]]
observable = "Increased use of anonymization tools (e.g., Tor, VPNs)"
priority = "medium"
detection_method = "Network traffic analysis, security logs"
false_positive_rate = "high"

[[indicators]]
observable = "Social media monitoring for leaked information or discussions about the target"
priority = "medium"
detection_method = "OSINT tools, social media analysis"
false_positive_rate = "high"

[[indicators]]
observable = "Physical observation of facilities, particularly infrastructure points"
priority = "high"
detection_method = "Physical security personnel, CCTV footage"
false_positive_rate = "low"

# ============================================================================
# TOOLCHAIN (1n Defensive + 2n Offensive)
# ============================================================================
# Dual-mode tool stacks: same tools, different semantic context.
# ============================================================================

[[toolchain]]
tool = "Nmap"
mode_1n = "Discover open ports and services to identify potential vulnerabilities"
mode_2n = "Map network topology and identify target systems"
escalation_level = "script"
kali_package = "nmap"
resource_cost = "low"

[[toolchain]]
tool = "Wireshark"
mode_1n = "Analyze network traffic to identify suspicious activity"
mode_2n = "Capture and analyze network traffic to extract sensitive information"
escalation_level = "microkernel"
kali_package = "wireshark"
resource_cost = "low"

[[toolchain]]
tool = "Metasploit"
mode_1n = "Test security controls and patch vulnerabilities"
mode_2n = "Exploit vulnerabilities to gain access to target systems"
escalation_level = "crate"
kali_package = "metasploit-framework"
resource_cost = "medium"

[[toolchain]]
tool = "Burp Suite"
mode_1n = "Identify web application vulnerabilities"
mode_2n = "Exploit web application vulnerabilities"
escalation_level = "crate"
kali_package = "burpsuite"
resource_cost = "medium"

[[toolchain]]
tool = "Hydra"
mode_1n = "Conduct password audits to identify weak credentials"
mode_2n = "Brute-force login credentials"
escalation_level = "script"
kali_package = "hydra"
resource_cost = "low"

[[toolchain]]
tool = "Recon-ng"
mode_1n = "Map an organization's public footprint"
mode_2n = "Gather data for reconnaissance"
escalation_level = "script"
kali_package = "recon-ng"
resource_cost = "low"

# ============================================================================
# GEOSPATIAL INTELLIGENCE (GEE + Weather + Traffic + COMINT)
# ============================================================================
# Location-dependent intelligence requirements and operational factors.
# ============================================================================

[geospatial]
gee_required = true
gee_layers = [
  "USGS/SRTMGL1_003",
  "MODIS/006/MCD12Q1",
  "COPERNICUS/S2",
  "JRC/GSW1_3/GlobalSurfaceWater"
]

# Distance and time constraints
distance_range = { min_km = 0.5, max_km = 50, optimal_km = 5 }
time_to_target = { min_minutes = 15, max_minutes = 180, optimal_minutes = 45 }

# Terrain factors (affects approach, escape, line-of-sight)
terrain_factors = ["urban_density", "line_of_sight", "elevation", "vegetation_cover"]

# Weather impact (from existing weather_data table)
[geospatial.weather]
critical_factors = ["visibility", "precipitation", "wind_speed", "cloud_cover"]
operational_threshold = { visibility_km = 5.0, wind_speed_ms = 15.0 }
impact_on_surveillance = "High visibility enhances drone reconnaissance and visual observation."
impact_on_comms = "Heavy precipitation can disrupt wireless communications."

# Traffic and routing (from pgRouting + PostGIS)
[geospatial.traffic]
road_network_required = true
routing_algorithm = "pgr_dijkstra"
cost_factors = ["time_cost", "risk_cost", "slope_cost", "darkness_cost"]
escape_route_priority = "high"
choke_point_analysis = true
traffic_pattern_window = { peak_hours = [7, 9, 16, 19], off_peak_hours = [22, 6] }

# COMINT (Communications Intelligence)
[geospatial.comint]
cell_tower_coverage = true
cell_tower_range_m = 5000
signal_strength_threshold_dbm = -90
imsi_tracking = false
wifi_mapping = true
wifi_tools = ["wigle", "kismet", "aircrack-ng"]
frequency_bands = ["GSM-900", "GSM-1800", "UMTS-2100", "LTE-700", "LTE-2600", "5G-3500"]

# Critical infrastructure proximity
[geospatial.infrastructure]
critical_assets = ["power_grid", "telecom_hub", "transit_station", "emergency_services"]
proximity_threshold_m = 500
impact_assessment = "Proximity to critical infrastructure enhances the impact of a successful attack."

# ============================================================================
# NIEM/N-DEx ONTOLOGICAL MAPPING
# ============================================================================
# Maps CTAS ontology to NIEM IEPDs for law enforcement interoperability.
# ============================================================================

[niem_mapping]
justice_domain = "j:CyberCrime"
intelligence_domain = "intel:ThreatIntelligenceReport"
iepd_type = "Cyber-Incident-Exchange"
iepd_version = "5.3"

# N-DEx field mapping
[niem_mapping.ndex_fields]
incident_category = "Network Intrusion"
incident_subcategory = "Reconnaissance"
location_type = "Data Center"
subject_role = "Threat Actor"
activity_type = "Cyber Reconnaissance"

# NIEM core elements
[niem_mapping.niem_core]
"nc:Activity" = "Cyber Reconnaissance"
"nc:ActivityDate" = "{ collection_phase }"
"nc:Location" = "{ target_network }"
"j:Charge" = "18 USC 1030 (Computer Fraud and Abuse Act)"

# ============================================================================
# RELATIONSHIPS (Graph Edges)
# ============================================================================
# Defines how this node connects to other nodes in the 165-task graph.
# ============================================================================

[[relationships]]
target_node = "uuid-102-000-000-A"
relationship_type = "enables"
unicode_op = "‚Üí"
strength = 0.9
description = "Detailed infrastructure reconnaissance enables vulnerability assessment."

[[relationships]]
target_node = "uuid-103-000-000-A"
relationship_type = "informs"
unicode_op = "‚á¢"
strength = 0.8
description = "Cyber reconnaissance informs attack planning."

[[relationships]]
target_node = "uuid-120-000-000-A"
relationship_type = "vulnerable_to"
unicode_op = "‚ö†"
strength = 0.7
description = "Cyber reconnaissance is vulnerable to intrusion detection and incident response."

# ============================================================================
# EEI PRIORITY (Essential Elements of Information)
# ============================================================================
# Ranked intelligence requirements for this task.
# ============================================================================

[[eei_priority]]
rank = 1
question = "What is the network topology and architecture?"
collection_method = "Network scanning, traffic analysis, OSINT"
time_sensitivity = "high"

[[eei_priority]]
rank = 2
question = "What are the open ports and services running on target systems?"
collection_method = "Port scanning, banner grabbing"
time_sensitivity = "high"

[[eei_priority]]
rank = 3
question = "What are the vulnerabilities and misconfigurations in target systems and applications?"
collection_method = "Vulnerability scanning, penetration testing"
time_sensitivity = "medium"

[[eei_priority]]
rank = 4
question = "What are the security controls and defenses in place?"
collection_method = "Network mapping, security audits"
time_sensitivity = "medium"

[[eei_priority]]
rank = 5
question = "What is the security awareness of employees?"
collection_method = "Social engineering, phishing simulations"
time_sensitivity = "low"

# ============================================================================
# HISTORICAL REFERENCE (Real-World Examples)
# ============================================================================
# Links to actual incidents where this task was observed.
# ============================================================================

[historical_reference]
incidents = [
  {
    name = "Target Data Breach",
    date = "2013-11-27",
    description = "Attackers gained initial access through a third-party vendor and then moved laterally through the network, identifying and exploiting vulnerabilities to access point-of-sale systems.",
    source = "https://en.wikipedia.org/wiki/2013_Target_data_breach"
  },
  {
    name = "Equifax Data Breach",
    date = "2017-07-29",
    description = "Attackers exploited a known vulnerability in Apache Struts to gain access to Equifax's systems and steal sensitive data.",
    source = "https://en.wikipedia.org/wiki/Equifax_data_breach"
  },
  {
    name = "SolarWinds Supply Chain Attack",
    date = "2020-12-13",
    description = "Attackers compromised SolarWinds' Orion software build process to inject malicious code into updates, which were then distributed to thousands of customers.",
    source = "https://www.cisa.gov/news-events/news/joint-statement-cybersecurity-and-infrastructure-security-agency-fbi-nsa-and"
  }
]

# ============================================================================
# TTPS (Tactics, Techniques, and Procedures)
# ============================================================================
# MITRE ATT&CK mapping for cyber TTPs (where applicable).
# ============================================================================

[[ttps]]
mitre_attack_id = "T1595"
tactic = "Reconnaissance"
technique = "Active Scanning"
sub_technique = "T1595.002 - Vulnerability Scanning"
description = "Use vulnerability scanning tools to identify potential weaknesses."

[[ttps]]
mitre_attack_id = "T1592"
tactic = "Reconnaissance"
technique = "Gather Victim Infrastructure Information"
sub_technique = "T1592.004 - Software"
description = "Identify software versions running on target systems."

[[ttps]]
mitre_attack_id = "T1590"
tactic = "Reconnaissance"
technique = "Gather Victim Network Information"
sub_technique = "T1590.002 - DNS"
description = "Gather DNS information about the target network."

[[ttps]]
mitre_attack_id = "T1589"
tactic = "Reconnaissance"
technique = "Gather Victim Identity Information"
sub_technique = "T1589.001 - Credentials"
description = "Gather credentials from publicly available sources."

[[ttps]]
mitre_attack_id = "T1598"
tactic = "Reconnaissance"
technique = "Phishing for Information"
sub_technique = "T1598.003 - Spearphishing Link"
description = "Send spearphishing emails to gather intelligence."

[[ttps]]
mitre_attack_id = "T1190"
tactic = "Initial Access"
technique = "Exploit Public-Facing Application"
description = "Exploit a vulnerability in a public-facing web application to gain initial access."

# ============================================================================
# XSD INTEGRATION (Playbook Orchestration)
# ============================================================================
# Links this node to XSD playbooks for executable document generation.
# ============================================================================

[xsd_integration]
playbook_template = "cyber_reconnaissance_playbook_v7.3.1.xsd"
crate_orchestration = ["ctas7-foundation-cyber", "ctas7-enhanced-threatintel"]
unicode_assembly = ["‚Üí", "‚á¢", "‚ö†", "üëÅ", "üìç", "üíª"]
lisp_expression = "(cyber-recon-task :target target-id :phase pre-attack :priority critical)"

# ============================================================================
# METADATA (System Fields)
# ============================================================================

[metadata]
schema_version = "7.3.1"
created_by = "GPT-4"
created_at = "2024-10-27T00:00:00Z"
last_updated = "2024-10-27T00:00:00Z"
reviewed_by = "Human Analyst"
status = "active"
```