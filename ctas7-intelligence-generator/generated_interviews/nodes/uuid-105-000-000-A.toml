```toml
# ============================================================================
# CTAS-7 Node Interview Schema v7.3.1
# Complete Intelligence Integration Architecture
# ============================================================================
# This is the canonical schema for generating 165 node interviews from the
# IED TTL (Terrorist IED Task List). Each node represents an adversary task
# with first-person narrative, intelligence requirements, and operational context.
#
# Integration Points:
# - Computational: Trivariate hashing (SCH+CUID+UUID), Unicode ops, XSD
# - Semantic: First-person narrative, EEIs, TTPs, relationships
# - Tactical: HD4 phase mapping (Hunt/Detect/Disrupt/Disable/Dominate)
# - Ontological: NIEM IEPD alignment, N-DEx field mapping
# - Toolchain: 1n (defensive) + 2n (offensive) tool stacks
# - Geospatial: GEE layers, weather, traffic, COMINT, terrain
# ============================================================================

[node_identity]
task_id = "uuid-105-000-000-A"              # TTL task identifier
task_name = "Task 105 - Phase 3"
classification = "unclassified"              # or "cui", "secret", etc.
ttl_category = "desirable"                   # mandatory | desirable | optional

# ============================================================================
# TRIVARIATE HASH (48-position Base96: SCH-CUID-UUID)
# ============================================================================
# Generated via Murmur3 with different seeds for each component.
# Full hash example: "Xk9mP2vL8qR4wN7jT20250109G40N74SU5e8400e29b41d4a"
# ============================================================================

sch = "B75jK2p9sD1LmXyQ"                    # Positions 1-16: Semantic Content Hash
                                             # Deterministic, content-based
                                             # Seed: 0x1234 (Murmur3)
                                             # Input: task_name + ttl_category + indicators

cuid = "T20241115G34S82Sg9r120z"                    # Positions 17-32: Contextual Unique ID
                                             # Spatio-temporal + semantic context
                                             # Seed: 0x5678 (Murmur3)
                                             # Format breakdown:
                                             #   T20250109 = Temporal (8 chars): YYYYMMDD or T-{offset}d
                                             #   G40N74    = Geographic (6 chars): Compressed lat/lon
                                             #   S         = Semantic domain (2 chars): "Sr" = Surveillance/Recon
                                             # Full encoding: T{time}G{geo}S{semantic}

uuid = "W6g39p1q4r8s2t5u"                    # Positions 33-48: Universal Unique ID
                                             # Global uniqueness, persistence, audit trail
                                             # Seed: 0x9abc (Murmur3)
                                             # Input: UUID v4 + content + timestamp

hash_48 = "B75jK2p9sD1LmXyQT20241115G34S82Sg9r120zW6g39p1q4r8s2t5u"  # Full 48-char hash

# ============================================================================
# FIRST-PERSON ADVERSARY NARRATIVE
# ============================================================================
# This is the core intelligence requirement. Written from the adversary's
# perspective, describing capabilities, methods, and intent.
# ============================================================================

[capabilities]
narrative = """
I am the whisper in the wind. I exploit vulnerabilities found during the initial phases,
now moving to exploit weaknesses. I focus on disrupting security measures, creating openings
for further actions. I disable alarm systems by cutting power lines. I introduce malware via
infected USB drives, creating backdoors.

I manipulate access control systems by cloning RFID cards. I use social engineering to gain physical
access to restricted areas. I monitor communications channels, intercepting sensitive information.
I use advanced techniques to bypass security protocols.

I exploit vulnerabilities discovered in phase 1 to gain deeper access. I observe network traffic to
identify sensitive data flows. I install keyloggers on critical systems. I corrupt surveillance footage
to cover my tracks. I am the implementor of chaos, the breaker of order.
"""

limitations = """
My actions are easily detectable if proper security measures are in place. Advanced alarm systems,
intrusion detection systems, and vigilant security personnel can quickly identify my activities.
Physical tampering leaves forensic evidence. Digital footprints are hard to erase completely.

I am vulnerable to well-trained security teams and robust incident response protocols. My effectiveness
decreases with time as vulnerabilities are patched. My activities are limited by the defenses in place,
requiring constant adaptation. My resources are not unlimited.
"""

# ============================================================================
# TIME-OF-VALUE (Intelligence Decay)
# ============================================================================
# Defines the actionable window and decay curve for this intelligence type.
# Uses "on the order of" language for human readability + numerical ranges.
# ============================================================================

[time_of_value]
half_life = { words = "hours to days", range = [12, 48], units = "hours" }
collection_phase = { words = "weeks to months before", range = [4, 12], units = "weeks" }
actionable_window = { words = "hours to days", range = [24, 72], units = "hours" }
decay_curve = "exponential"  # exponential | linear | step_function
ephemeral_conditions = [
  "Security system upgrades (new sensors, alarms)",
  "Software patches and vulnerability fixes",
  "Increased security awareness training",
  "Implementation of stricter access control measures"
]
persistence_conditions = [
  "Physical infrastructure dependencies (power, network)",
  "Unpatched legacy systems",
  "Human error and vulnerabilities",
  "Lack of security monitoring and incident response"
]

# ============================================================================
# CONTEXTUAL HASHING (CUID Mask with Environmental Context)
# ============================================================================
# The CUID (positions 17-32) encodes spatio-temporal + semantic + environmental
# context using PREFIX and SUFFIX masks from CTAS 7.3 Ground Truth.
# ============================================================================

[cuid_mask]
# Temporal context
temporal = "T-{4-12}w"                     # Collection window: 4-12 weeks before attack
temporal_format = "YYYYMMDD"                 # Or "T-{offset}d" for relative time

# Geographic context
geographic = "G{lat}{lon}"                   # Compressed: G40N74 = 40.7¬∞N, 74.0¬∞W
geographic_radius_km = 2.0                   # Operational radius from target

# Semantic domain
semantic = "Sg"                              # Two-char code: Sr = Surveillance/Recon
semantic_full = "exploitation:security:bypass"  # Full ontology path

# PREFIX MASKS (Global Environmental Context) - Domain-Specific
[cuid_mask.prefix]
# Universal masks (all domains)
WX = "weather_mask"                          # Physical: Visibility, precip, wind, temp
                                             # Cyber: Network weather (latency, jitter)
                                             # Space: Solar radiation, space weather
                                             # Maritime: Sea state, visibility, wind

TF = "traffic_mask"                          # Physical: Road speed, congestion
                                             # Cyber: Network traffic, bandwidth utilization
                                             # Space: Orbital congestion, debris density
                                             # Maritime: Shipping lane traffic

OB = "order_of_battle_mask"                  # Friendly/enemy posture (all domains)
JU = "jurisdiction_mask"                     # Legal/authority overlay (all domains)
TH = "threat_posture_mask"                   # Threat level indicators (all domains)

# Domain-Specific Extensions (v7.3)
[cuid_mask.prefix.space]
SR = "solar_radiation"                       # Solar radiation impact (0-1)
GM = "geomagnetic_disturbance"               # Geomagnetic storm activity (0-1)
DE = "debris_density"                        # Orbital debris field density (0-1)
JS = "jurisdictional_shell"                  # LEO/MEO/GEO orbital layer

[cuid_mask.prefix.cyber]
NW = "network_weather"                       # Latency, jitter, packet loss
DT = "data_traffic"                          # Bandwidth utilization, flow rate
AS = "attack_surface"                        # Exposed services, vulnerabilities
FW = "firewall_posture"                      # Security boundary status

[cuid_mask.prefix.maritime]
SS = "sea_state"                             # Wave height, sea conditions (Beaufort scale)
CT = "current_tide"                          # Ocean currents, tidal state
SL = "shipping_lanes"                        # Proximity to commercial traffic
TW = "territorial_waters"                    # Jurisdictional boundaries (12nm, 200nm EEZ)
SC = "submarine_cables"                      # Proximity to undersea infrastructure
PT = "port_traffic"                          # Harbor/port congestion

[cuid_mask.prefix.network]
TP = "topology"                              # Network topology complexity
RT = "routing"                               # Routing table stability, BGP health
LT = "latency"                               # End-to-end latency metrics
PL = "packet_loss"                           # Packet loss percentage
BU = "bandwidth_utilization"                 # Link utilization percentage
AS = "autonomous_system"                     # AS-level routing context

# SUFFIX MASKS (Local Operational Context)
[cuid_mask.suffix]
RP = "personnel_availability"                # Staffing levels (or automated systems)
RE = "equipment_readiness"                   # Operational status
RS = "supplies_availability"                 # Resource/fuel availability
BW = "bandwidth_comms"                       # Connectivity status
RO = "rules_of_engagement"                   # Legal constraints

# Priority
priority = "high"                            # low | medium | high | critical

# ============================================================================
# HD4 TACTICAL MAPPING
# ============================================================================
# Maps this node to the 5 phases of the HD4 kill chain.
# ============================================================================

[hd4_phases]
hunt = { enabled = true, priority = "high", description = "Proactive search for exploitation patterns" }
detect = { enabled = true, priority = "critical", description = "Identify signs of security bypass in real-time" }
disrupt = { enabled = true, priority = "medium", description = "Implement countermeasures to halt exploitation" }
disable = { enabled = true, priority = "high", description = "Neutralize exploited vulnerabilities" }
dominate = { enabled = false, priority = "low", description = "N/A" }

# ============================================================================
# INDICATORS (Observable Signatures)
# ============================================================================
# Key indicators that this task is occurring. Used for detection and hunting.
# ============================================================================

[[indicators]]
observable = "Unauthorized access attempts to restricted areas"
priority = "critical"
detection_method = "Access control logs, alarm system triggers"
false_positive_rate = "low"

[[indicators]]
observable = "Compromised RFID card usage"
priority = "high"
detection_method = "Access control logs, security personnel observation"
false_positive_rate = "medium"

[[indicators]]
observable = "Malware infections via USB drives"
priority = "critical"
detection_method = "Endpoint detection and response (EDR), antivirus alerts"
false_positive_rate = "low"

[[indicators]]
observable = "Disrupted alarm system functionality"
priority = "high"
detection_method = "Alarm system logs, manual inspection"
false_positive_rate = "medium"

[[indicators]]
observable = "Intercepted communication channels"
priority = "critical"
detection_method = "Network traffic analysis, intrusion detection systems"
false_positive_rate = "low"

[[indicators]]
observable = "Anomalous network traffic patterns"
priority = "high"
detection_method = "Network intrusion detection systems (NIDS), security information and event management (SIEM)"
false_positive_rate = "medium"

[[indicators]]
observable = "Corrupted surveillance footage"
priority = "medium"
detection_method = "Video integrity checks, timestamp analysis"
false_positive_rate = "high"

[[indicators]]
observable = "Keylogger activity on critical systems"
priority = "critical"
detection_method = "Endpoint detection and response (EDR), host-based intrusion detection systems (HIDS)"
false_positive_rate = "low"

[[indicators]]
observable = "Exploitation of known vulnerabilities"
priority = "high"
detection_method = "Vulnerability scanners, penetration testing"
false_positive_rate = "medium"

[[indicators]]
observable = "Unauthorized modification of access control policies"
priority = "critical"
detection_method = "Security audits, configuration management tools"
false_positive_rate = "low"

# ============================================================================
# TOOLCHAIN (1n Defensive + 2n Offensive)
# ============================================================================
# Dual-mode tool stacks: same tools, different semantic context.
# ============================================================================

[[toolchain]]
tool = "Metasploit"
mode_1n = "Conduct penetration testing to identify and patch vulnerabilities"
mode_2n = "Exploit identified vulnerabilities to gain unauthorized access"
escalation_level = "crate"
kali_package = "metasploit-framework"
resource_cost = "high"

[[toolchain]]
tool = "Nmap"
mode_1n = "Scan network for open ports and services to identify potential weaknesses"
mode_2n = "Map network topology and enumerate services for exploitation targets"
escalation_level = "script"
kali_package = "nmap"
resource_cost = "low"

[[toolchain]]
tool = "Wireshark"
mode_1n = "Analyze network traffic to detect suspicious activity and data leaks"
mode_2n = "Capture and analyze network packets to intercept sensitive information"
escalation_level = "microkernel"
kali_package = "wireshark"
resource_cost = "medium"

[[toolchain]]
tool = "Hydra"
mode_1n = "Audit password strength and access control systems"
mode_2n = "Brute-force passwords to bypass authentication mechanisms"
escalation_level = "script"
kali_package = "hydra"
resource_cost = "low"

[[toolchain]]
tool = "Mimikatz"
mode_1n = "Identify and mitigate credential harvesting techniques"
mode_2n = "Extract credentials from memory to gain privileged access"
escalation_level = "crate"
kali_package = "N/A"
resource_cost = "medium"

[[toolchain]]
tool = "Burp Suite"
mode_1n = "Perform web application security testing and vulnerability analysis"
mode_2n = "Intercept and manipulate web traffic to exploit application flaws"
escalation_level = "crate"
kali_package = "burpsuite"
resource_cost = "high"

# ============================================================================
# GEOSPATIAL INTELLIGENCE (GEE + Weather + Traffic + COMINT)
# ============================================================================
# Location-dependent intelligence requirements and operational factors.
# ============================================================================

[geospatial]
gee_required = true
gee_layers = [
  "USGS/SRTMGL1_003",                        # Elevation (30m resolution)
  "MODIS/006/MCD12Q1",                       # Land cover classification
  "COPERNICUS/S2",                           # Sentinel-2 optical imagery
  "JRC/GSW1_3/GlobalSurfaceWater"            # Water bodies
]

# Distance and time constraints
distance_range = { min_km = 0.1, max_km = 10, optimal_km = 1 }
time_to_target = { min_minutes = 5, max_minutes = 60, optimal_minutes = 20 }

# Terrain factors (affects approach, escape, line-of-sight)
terrain_factors = ["urban_density", "line_of_sight", "elevation", "vegetation_cover"]

# Weather impact (from existing weather_data table)
[geospatial.weather]
critical_factors = ["visibility", "precipitation", "wind_speed", "cloud_cover"]
operational_threshold = { visibility_km = 2.0, wind_speed_ms = 10.0 }
impact_on_surveillance = "Low visibility impacts covert movement and activities"
impact_on_comms = "Heavy precipitation may affect wireless communications"

# Traffic and routing (from pgRouting + PostGIS)
[geospatial.traffic]
road_network_required = true
routing_algorithm = "pgr_dijkstra"           # or pgr_astar, pgr_trsp
cost_factors = ["time_cost", "risk_cost", "slope_cost", "darkness_cost"]
escape_route_priority = "high"
choke_point_analysis = true
traffic_pattern_window = { peak_hours = [7, 9, 16, 19], off_peak_hours = [22, 6] }

# COMINT (Communications Intelligence)
[geospatial.comint]
cell_tower_coverage = true
cell_tower_range_m = 2000
signal_strength_threshold_dbm = -80
imsi_tracking = false                        # 1n: detect adversary, 2n: track target
wifi_mapping = true
wifi_tools = ["wigle", "kismet", "aircrack-ng"]
frequency_bands = ["GSM-900", "GSM-1800", "UMTS-2100", "LTE-700", "LTE-2600", "5G-3500"]

# Critical infrastructure proximity
[geospatial.infrastructure]
critical_assets = ["power_grid", "telecom_hub", "transit_station", "emergency_services"]
proximity_threshold_m = 200
impact_assessment = "Proximity to critical infrastructure increases the potential for widespread impact"

# ============================================================================
# NIEM/N-DEx ONTOLOGICAL MAPPING
# ============================================================================
# Maps CTAS ontology to NIEM IEPDs for law enforcement interoperability.
# ============================================================================

[niem_mapping]
justice_domain = "j:CriminalInvestigation"
intelligence_domain = "intel:SuspiciousActivityReport"
iepd_type = "Incident-Exchange"
iepd_version = "5.2"

# N-DEx field mapping
[niem_mapping.ndex_fields]
incident_category = "Security Breach"
incident_subcategory = "System Exploitation"
location_type = "Critical Infrastructure"
subject_role = "Suspect"
activity_type = "Exploitation of Security Systems"

# NIEM core elements
[niem_mapping.niem_core]
"nc:Activity" = "Exploitation"
"nc:ActivityDate" = "{ collection_phase }"
"nc:Location" = "{ target_location }"
"j:Charge" = "18 USC 1030 (Computer Fraud and Abuse Act), 18 USC 1361 (Destruction of Government Property)"

# ============================================================================
# RELATIONSHIPS (Graph Edges)
# ============================================================================
# Defines how this node connects to other nodes in the 165-task graph.
# ============================================================================

[[relationships]]
target_node = "uuid-110-000-000-A"           # Infiltration
relationship_type = "enables"
unicode_op = "‚Üí"                             # Directional flow
strength = 0.90                              # 0.0-1.0 (how critical is this link)
description = "Bypassing security measures directly enables infiltration"

[[relationships]]
target_node = "uuid-120-000-000-A"           # Data Exfiltration
relationship_type = "enables"
unicode_op = "‚Üí"
strength = 0.85
description = "Exploitation of vulnerabilities enables data exfiltration"

[[relationships]]
target_node = "uuid-025-000-000-A"           # Counter-Surveillance
relationship_type = "vulnerable_to"
unicode_op = "‚ö†"
strength = 0.70
description = "Exploitation is vulnerable to strong intrusion detection systems"

# ============================================================================
# EEI PRIORITY (Essential Elements of Information)
# ============================================================================
# Ranked intelligence requirements for this task.
# ============================================================================

[[eei_priority]]
rank = 1
question = "What are the specific vulnerabilities in the security systems?"
collection_method = "Penetration testing, vulnerability scanning, dark web sources"
time_sensitivity = "high"

[[eei_priority]]
rank = 2
question = "What are the default configurations and weak passwords?"
collection_method = "Brute-force attacks, password audits, insider information"
time_sensitivity = "high"

[[eei_priority]]
rank = 3
question = "What are the network segmentation and firewall rules?"
collection_method = "Network mapping, traffic analysis, configuration audits"
time_sensitivity = "medium"

[[eei_priority]]
rank = 4
question = "What are the logging and monitoring capabilities?"
collection_method = "System logs, SIEM data, reconnaissance"
time_sensitivity = "medium"

[[eei_priority]]
rank = 5
question = "What are the incident response procedures?"
collection_method = "Social engineering, open-source intelligence, internal documentation"
time_sensitivity = "low"

# ============================================================================
# HISTORICAL REFERENCE (Real-World Examples)
# ============================================================================
# Links to actual incidents where this task was observed.
# ============================================================================

[historical_reference]
incidents = [
  {
    name = "Target Data Breach (2013)",
    date = "2013-11-27",
    description = "Attackers exploited vulnerabilities in the HVAC system to gain access to the network",
    source = "https://en.wikipedia.org/wiki/2013_Target_data_breach"
  },
  {
    name = "Equifax Data Breach (2017)",
    date = "2017-05-13",
    description = "Exploitation of an Apache Struts vulnerability to steal sensitive data",
    source = "https://en.wikipedia.org/wiki/Equifax_data_breach"
  },
  {
    name = "Colonial Pipeline Ransomware Attack (2021)",
    date = "2021-05-07",
    description = "Ransomware attack exploiting weak security measures",
    source = "https://en.wikipedia.org/wiki/Colonial_Pipeline_ransomware_attack"
  }
]

# ============================================================================
# TTPS (Tactics, Techniques, and Procedures)
# ============================================================================
# MITRE ATT&CK mapping for cyber TTPs (where applicable).
# ============================================================================

[[ttps]]
mitre_attack_id = "T1190"
tactic = "Initial Access"
technique = "Exploit Public-Facing Application"
sub_technique = ""
description = "Exploiting vulnerabilities in publicly accessible applications"

[[ttps]]
mitre_attack_id = "T1078"
tactic = "Defense Evasion, Persistence, Privilege Escalation, Initial Access"
technique = "Valid Accounts"
sub_technique = "T1078.001 - Default Accounts"
description = "Using default or known credentials"

[[ttps]]
mitre_attack_id = "T1059"
tactic = "Execution"
technique = "Command and Scripting Interpreter"
sub_technique = "T1059.001 - PowerShell"
description = "Executing commands via PowerShell"

[[ttps]]
mitre_attack_id = "T1068"
tactic = "Privilege Escalation"
technique = "Exploitation for Privilege Escalation"
sub_technique = ""
description = "Exploiting system vulnerabilities to gain higher privileges"

[[ttps]]
mitre_attack_id = "T1003"
tactic = "Credential Access"
technique = "OS Credential Dumping"
sub_technique = "T1003.001 - LSASS Memory"
description = "Dumping credentials from LSASS memory"

# ============================================================================
# XSD INTEGRATION (Playbook Orchestration)
# ============================================================================
# Links this node to XSD playbooks for executable document generation.
# ============================================================================

[xsd_integration]
playbook_template = "exploitation_playbook_v7.3.1.xsd"
crate_orchestration = ["ctas7-foundation-tactical", "ctas7-enhanced-exploitation"]
unicode_assembly = ["‚Üí", "‚ö†", "‚ö†", "üëÅ", "üìç", "‚öô"]
lisp_expression = "(exploit-task :target target-id :phase exploitation :priority critical)"

# ============================================================================
# METADATA (System Fields)
# ============================================================================

[metadata]
schema_version = "7.3.1"
created_by = "Marcus Chen (Gemini 2M)"
created_at = "2025-01-10T00:00:00Z"
last_updated = "2025-01-10T00:00:00Z"
reviewed_by = "Natasha Volkov"
status = "active"                            # draft | active | deprecated
```